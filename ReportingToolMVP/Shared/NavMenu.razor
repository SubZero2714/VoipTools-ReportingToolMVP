<div class="sidebar @(IsCollapsed ? "sidebar-collapsed" : "sidebar-expanded")">
    <!-- Header with brand and collapse button -->
    <div class="sidebar-header">
        <div class="brand">
            <div class="brand-logo">
                <span class="oi oi-bar-chart"></span>
            </div>
            @if (!IsCollapsed)
            {
                <span class="brand-text">VoIPTools Reporting</span>
            }
        </div>
        @if (!IsCollapsed)
        {
            <button type="button" class="toggle-btn" @onclick="ToggleSidebar" @onclick:preventDefault @onclick:stopPropagation title="Collapse">
                <span class="oi oi-chevron-left"></span>
            </button>
        }
    </div>
    @if (IsCollapsed)
    {
        <button type="button" class="toggle-btn-collapsed" @onclick="ToggleSidebar" @onclick:preventDefault @onclick:stopPropagation title="Expand">
            <span class="oi oi-chevron-right"></span>
        </button>
    }

    <!-- Navigation Links -->
    <nav class="sidebar-nav">
        <a href="reportdesigner" class="nav-item @(IsActive("reportdesigner") ? "active" : "")">
            <span class="nav-icon oi oi-brush"></span>
            @if (!IsCollapsed)
            {
                <span class="nav-label">Report Designer</span>
            }
        </a>

        <a href="reportviewer" class="nav-item @(IsActive("reportviewer") ? "active" : "")">
            <span class="nav-icon oi oi-document"></span>
            @if (!IsCollapsed)
            {
                <span class="nav-label">Report Viewer</span>
            }
        </a>

        <a href="schedulereports" class="nav-item @(IsActive("schedulereports") ? "active" : "")">
            <span class="nav-icon oi oi-timer"></span>
            @if (!IsCollapsed)
            {
                <span class="nav-label">Schedule Reports</span>
            }
        </a>
    </nav>

    <!-- Footer section (optional - for settings/help) -->
    <div class="sidebar-footer">
        <a href="#" class="nav-item">
            <span class="nav-icon oi oi-cog"></span>
            @if (!IsCollapsed)
            {
                <span class="nav-label">Settings</span>
            }
        </a>
    </div>
</div>

@code {
    [Inject]
    private NavigationManager? NavigationManager { get; set; }

    private bool IsCollapsed = false;

    private void ToggleSidebar()
    {
        IsCollapsed = !IsCollapsed;
    }

    private bool IsActive(string href)
    {
        var relativePath = NavigationManager?.ToBaseRelativePath(NavigationManager.Uri) ?? "";
        if (string.IsNullOrEmpty(href))
        {
            return string.IsNullOrEmpty(relativePath);
        }
        return relativePath.StartsWith(href, StringComparison.OrdinalIgnoreCase);
    }
}
